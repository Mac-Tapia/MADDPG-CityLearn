# Kustomization para MADDPG CityLearn - CTDE Cooperative Model
# ============================================================================
# Modelo: MADDPG con paradigma CTDE (Centralized Training, Decentralized Execution)
# - 17 agentes (edificios) cooperando para optimización energética del distrito
# - Entrenado por 50 episodios (438,000 steps) en dataset citylearn_challenge_2022_phase_all_plus_evs
# - Team Reward: Todos los agentes comparten la misma recompensa global
# Uso: kubectl apply -k kubernetes/

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: maddpg-citylearn-ctde

# Namespace donde se despliegan los recursos
namespace: default

# Recursos a desplegar (en orden de dependencias)
resources:
  # Seguridad
  - rbac.yaml
  - secrets.yaml
  # Configuración CTDE
  - configmap-pvc.yaml
  # Despliegue
  - deployment.yaml
  - deployment-secure.yaml
  - service.yaml
  # Escalado
  - hpa.yaml
  # Red
  - networkpolicy.yaml
  - ingress.yaml
  # Monitoreo (requiere Prometheus Operator)
  - monitoring.yaml

# Etiquetas comunes para todos los recursos
commonLabels:
  app.kubernetes.io/name: maddpg-citylearn
  app.kubernetes.io/component: api
  app.kubernetes.io/part-of: citylearn-energy
  app.kubernetes.io/managed-by: kustomize
  model-type: ctde-cooperative
  num-agents: "17"

# Anotaciones comunes
commonAnnotations:
  project: "maddpg-citylearn-tesis"
  environment: "production"
  model-paradigm: "CTDE"
  trained-episodes: "50"
  dataset: "citylearn_challenge_2022_phase_all_plus_evs"
  reward-type: "team-reward-cooperative"

# Imágenes - modelo CTDE entrenado 50 episodios
images:
  - name: maddpg-citylearn
    newTag: v3.0.0-ep50

# ConfigMap generator (alternativa al configmap estático)
# configMapGenerator:
# - name: maddpg-runtime-config
#   literals:
#     - LOG_LEVEL=INFO
#     - API_HOST=0.0.0.0
